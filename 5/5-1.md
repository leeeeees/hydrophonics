# 5.1. 컴퓨터란 무엇인가

컴퓨터는 정의하는 말에는 여러가지가 있다. 여기서는 컴퓨터의 범용성에 초점을 맞추어 이야기를 해볼까 한다. 컴퓨터 안에서는 미세한 전류가 흐르고 전류의 전압의 크기를 통해 0과 1이라는 수학적인 신호체계를 만든다. 이 신호체계를 통해 기계를 동작하게 하는 것이다.

그리고 입력신호를 받아 일정한 프로세스를 통해 출력신호를 보내는 기계이다. 다른 기계와 다른 점이 있다면 컴퓨터는 하나의 일만 하지 않고 여려가지 일을 수행하도록 설계되어 있다. 즉 하나의 기능만 하는 것이 아니라 범용적인 역할을 하고 여러기능들을 탑재할 수 있는게 다른 기계와 다른 점이다.

현대의 컴퓨터는 메모리 , 제어장치, 연산장치, 입/출력장치로 구성되어 있다. 이 구조는 데이타를 저장할수 있고 출력할수 있으면 특정한 연산을 할 수 있기 때문에 컴퓨터를 통해 순차적으로 명령를 수행시켜 특정한 작업 또는 연산을 할수 있다. 이런 순서에 따라 명령어를 실행시키는 것은 결국 프로그래밍이다. 프로그래밍은 대단한게 아닌 순서에 따라 어떤 작업을 하도록 하는게 프로그램밍이다. 결국 컴퓨터는 메모리에 기술된 명령어의 실행순서에 따라 명령어를 실행하고 특정한 작업을 수행하여 신호를 만드는 기계이다. 그런 단순한 수많은 작업 또는 연산을 통해 특정일을 수행하는 프로그램을 만드는 것이다.

### 5.1.1. 운영체제

하지만, 여기에서 문제가 있다. 컴퓨터를 제조하는 곳은 수없이 많고 컴퓨터안에 들어가는 부품들의 명령어의 체계 또한 제조사마다 다 다르다. 그래서 특정 컴퓨터에서는 동작하는 프로그램을 개발했지만 또 제조사가 다른 컴퓨터에서 동일한 프로그램을 실행시키기 위해서는 그 제조사의 명령어 맞게 다시 프로그램을 개발해야 하는 비효율이 발생한다. 결국의 종속성이 생기기 때문에 이런 문제점을 해결하고 컴퓨터의 자원을 더 효율적으로 관리하기 위해서 나온 소프트웨어가 운영체제이다. 운영체제는 컴퓨터의 자원을 관리한다. 컴퓨터의 하드웨어의 자원인 입/출력, 저장, 제어, 연산장치등을 통일된 체계안에서 관리하고 모든 프로그램들은 운영체제 를 통해 하드웨어를 제어해야 한다. 운영체제는 하드웨어를 제어할수 있는 인터페이스를 프로그램들에게 제공하고 프로그램들은 통일된 인터페이스를 통해 컴퓨터를 제어하기 하드웨어의 명령어를 몰라도 인터페이스만 맞추어 준다면 프로그램의 개발이 가능해졌다. 이말은 분업과 협업의 체계를 만들어진 걸로 볼수 있다. 하드웨어에 대한 깊이 있는 지식이 없이도 운영체제가 제공해주는 인터페이스의 사용법을 안다면 그 위에서 작업이 가능한다. 컴퓨터 화면에 사진을 출력하기 위해서 기계어 코드를 알 필요 없이 단순한 HTML만 알아도 브라우져는 화면에 그림을 출력해준다.

```text
<img src=“./plants.jpg” >
```

기계어로 변역해주는 작업은 사실 운영체제와 브라우져가 대신 해주고 있기 때문에 이런 일이 가능한 것이다. 그래서 운영체제가 있고 없고는 기존에 만들어 놓은 것을 이용할 수 있는냐 없는냐의 문제이다. 운영체제가 위에서 동작하는 프로그램은 코드도 짧아지고 높은 신뢰성을 확보할 수 있다. 라스베리파이는 기본적으로 운영체제가 설치되어 있고 따로 설치도 가능하다. 운영체제의 종류는 수 없이 많다. 그중 대표적인게 유닉스와 리눅스 그리고 원도우이다. 이중 리눅스는 오픈소스이고 누구나 자유롭게 사용이 가능한 라이선스를 가지고 있다. 라스베리파이 위에는 여려 운영체제가 설치가 가능하지만 기본적으로는 라스베리안이라는 리눅스의 변종이 설치되어 있다.

### 5.1.2. 라즈베리파이

라스베리파이는 컴퓨터과학 교육용으로 개발된 손바닥만 크기의 컴퓨터이다. 가격은 대략 5만원 ~6만원 정도하지만 컴퓨터로의 모든 기능을 가지고 있다. 또 일반 컴퓨터에는 보통 없는 GPIO 포트를 제공하기 떄문에 센서들과 결합된 프로젝트를 하기 수월하고 프로그램밍적인 제어가 편하게 구성되어 있다. 실험과 교육용으로 개발된 작은 미니 컴퓨터라고 생각하면 될 것 이다. 우리는 라스베리파이를 이용해서 인터넷에 우리의 식물의 생육과정을 보여줄 예정이다. 즉, 본 프로젝트에서 IOT \(Internet of Thing\) 중계기 역할을 담당할 것이다.

라즈베리파이에는 리눅스라는 운영체제가 설치되어 있다. 또 다른 운영체도 설치가 가능하다. 운영체제가 제공된다는 것은 그 운영체제 위에서 동작가능한 일반적인 소프트웨어와 프로그래밍을 모두 사용할 수 있다는 것을 의미한다. 그렇기 때문에 기존에 수많은 라이브러리와 프로그램들을 이용이 쉽다. 그런 이유 때문에 라스베리파이를 우리는 사용할 것이다.

### 5.1.3. 라즈베리파이와 아두이노의 연동

라스베리파이는 아쉽게도 아날로그 신호에 대한 핀을 제공하지 않는다. 라스베리파이에서 아날로그 신호를 받기 위해서는 아날로그 신호를 디지털로 변환해주는 장치가 필요하다. 그 용도를 우리는 아두이노를 이용하여 아날로그 신호를 디지털로 변환해주고 디지털신호로 변환된 정보를 시리얼 포트로 받을 에정이다.

라스베리파이의 시리얼포트를 접근하기 위해서 tty, dialout 그룹의 권한을 지정한다. 아래 명령어를 실행하여 아두이노를 사용할 준비를 마친것 이다.

```text
sudo apt-get install arduino
sudo usermod -a -G tty pi
sudo usermod -a -G dialout pi
```

### 5.1.4. 통신의 방법

 통신이란는 말은 어떤 상태나 정보를 다른 무언가로 전달하는 일을 하는 것이다. 우리가 누군가와 대화를 나눌때 우리는 여러 매체를 통해 의사를 전달하듯이 전산에서 통신을 하기 위해서는 여러 매체를 통해 정보를 전달할 수 있다. 통신의 핵심은 약속이다. 서로가 사전에 약속을 해야 어떤 부호가 어떤걸 의미하는지 알수 있다. 만약 내가 손을 하나 들고 있으면 그건 위급한 신호라는걸 사전에 약속했다면 손을 드는 것만으로 이 약속을 알고 있는 사람들은 나의 상태를 알 수 있을 것이다. 통신의 핵심은 약속이다. 그렇다면 우리는 그 약속을 있다면 어떠한 매체를 통해서 전달하든 그 의미를 알 수 있다. 컴퓨터 또한 다양한 방식을 통해 상태와 정보를 다른곳으로 전달한다. 그리고 그 방법과 체계는 다르지만 궁극적으로는 전류를 컴퓨터안에 흘려보내서 일렬의 부호체계를 만드는 것이다. 부호의 체계는 여러개가 있다. 컴퓨터 안에서 사용하는 통신 방법으로는 시리얼, I2C, 병렬통신등이 있다.

### 5.1.5. 시리얼 통신

여기에서는 가장 단순하면서도 가장 많이 사용하는 시리얼통신를 사용하는 방법을 보여드릴예정이다. 말해서 나와있듯히 시리얼 통신은 우리말로 하면 직렬통신을 의미한다. 컴퓨터는 내부적으로 여러방식으로 통신이 있다 그중에 가장 기본이 되고 가장 많이 사용하는 것이 시리얼통신이다. 신호를 순차적으로 일정하게 주고 받기 때문에 속도가 병렬통신보다는 느리지만 컴퓨터는 빛의 속도로 통신이 이루어지기 때문에 간단한 정보를 주고 받을때는 시리얼통신으로도 충분하다.

우리는 아두이노를 이용해서 가장 간단한 형태의 시리얼통신을 이 장에서는 먼저 할 예정이다. 시리얼은 Arduino 보드와 컴퓨터 또는 다른 장치 간의 통신에 사용됩니다. 모든 Arduino 보드에는 하나 이상의 직렬 포트 \(UART 또는 USART라고도 함\)가 있다. 아두이노는 보통 디지털핀 1번과 0번 핀이 컴퓨터와 통신을 하기 위한 선이다. 아래 코드는 직렬통신을 하기 위한 가장 기본이 되는 코드이다.

Code-1-1.nio

```text
int incomingByte = 0; 
​
void setup() {
  Serial.begin(9600); // #1 9600 bps
}
​
void loop() {
  // reply only when you receive data:
  if (Serial.available() > 0) { #2
    incomingByte = Serial.read(); #3
    Serial.print(“I received: “); #4
    Serial.println(incomingByte, DEC);
  }
}
```

위에 코드에서 `Serial.begin(9600)` 는 시리얼를 통해 1초에 9600 주기로 로 통신을 하겠다는 것이다. `if (Serial.available() > 0)` 코드는 시리얼 포트가 사용가능한지를 체크하는 코드이다. 코드에서는 시리얼 포트가 열려 있다면 `incomingByte = Serial.read(); #3` 데이타를 시리얼로 읽고 `Serial.print(“I received: “); #4` 를 시리얼로 쓰는 코드이다. 이렇게 간단한 방법을 통해 다른 컴퓨터로 정보를 전달할 수 있다. 그렇다면 아두이노가 신호를 보낸다면 라스베리파에서는 그 정보를 받아야 한다. 라스베리파에서 시리얼 정보를 받기 위해서는 아주 간단한 코드로 가능한다. 먼저 어떤 시리얼포트가 열려 있고 장치에 물려 있는지 확인한 다음에 그 포트를 같은 속도에 맞추어 수송신 코드를 작성하면 된다.

`Lsusb` 명령어를 커맨드창에 입력하면 현재 물러 있는 usb 장치를 볼수 있을 것이다. `ls -l /dev` 명령어를 사용하면 시리얼포트 장치를 확인할 수 있다. 라즈베리파이에서는 `/dev/serial0` 가 기본 시리얼포트로 사용하고 있다.

로우한 데이타를 확인 위해서는 아래 명령어로만으로도 데이타가 들어오는 것을 알 수 있다.

```text
stty -F /dev/serial0 raw 9600 cs8 clocal -cstopb
cat /dev/serial0
```

하지만 우리는 파이썬으로 제어하기 위해서는 아래와 터미널에 `python -m pip install pyserial` 명령어 실행하여 파이썬으로 시리얼통신을 제어하기 위한 라이브러리를 설치 할 수있다. Pyserial 코드가 설치가 되어 있다면 serial.py 라는 파일을 만들고 아래와 같이 코드를 입력하면 실행해서 이상이 없으면 파이썬으로 시리얼통신을 하기 위한 준비가 마무리된 것이다. \[코드 serial.py\]

```text
import serial
​
ser = serial.Serial (“/dev/serial0”)    #Open named port 
ser.baudrate = 9600
data = ser.read(10)                  
ser.write(data)              
ser.close()
```

실행은 `sudo python serial.py` 를 명령차 입력해서 실행하면 된다.

